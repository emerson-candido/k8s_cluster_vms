---
- name: Install ingress
  kubernetes.core.helm:
    name: "ingress"
    chart_ref: "ingress-nginx"
    chart_version: "{{ ingress_chart_version }}"
    chart_repo_url: "https://kubernetes.github.io/ingress-nginx"
    release_namespace: ingress
    create_namespace: true
    values:
      controller:
        resources:
          requests:
            cpu: 100m
            memory: 128Mi
          limits:
            cpu: 200m
            memory: 256Mi
        service:
          type: NodePort
          nodePorts: 
            http: 30080
            https: 30443
  become: false
  delegate_to: "localhost"